# μ „λµ λΉλ” μ»¤μ¤ν…€ μ§€ν‘ ν†µν•© μ™„λ£

## κ°μ”

μ „λµ λΉλ”(Strategy Builder)κ°€ μ΄μ  **APIμ—μ„ λ™μ μΌλ΅ μ§€ν‘ λ©λ΅μ„ λ¶λ¬μ™€** λ‚΄μ¥ μ§€ν‘μ™€ μ»¤μ¤ν…€ μ§€ν‘λ¥Ό λ¨λ‘ ν‘μ‹ν•©λ‹λ‹¤.

## λ³€κ²½ μ‚¬ν•­

### κΈ°μ΅΄ λ°©μ‹
- ν•λ“μ½”λ”©λ `INDICATOR_CATALOG` λ°°μ—΄ μ‚¬μ©
- 4κ° λ‚΄μ¥ μ§€ν‘λ§ ν‘μ‹ (EMA, SMA, RSI, ATR)
- μƒ μ§€ν‘ μ¶”κ°€ μ‹ μ½”λ“ μμ • ν•„μ”

### μƒλ΅μ΄ λ°©μ‹ β¨
- **APIμ—μ„ μ‹¤μ‹κ°„ λ΅λ“** (`indicatorApi.list()`)
- **λ‚΄μ¥ + μ»¤μ¤ν…€ μ§€ν‘ λ¨λ‘ ν‘μ‹**
- **μλ™ νλΌλ―Έν„° UI μƒμ„±** (params_schema κΈ°λ°)
- μƒ μ§€ν‘ λ“±λ΅ μ‹ μλ™ λ°μ

## μ£Όμ” κΈ°λ¥

### 1. λ™μ  μ§€ν‘ λ΅λ”©
```typescript
useEffect(() => {
  loadIndicators();
}, []);

const loadIndicators = async () => {
  const data = await indicatorApi.list();
  setAvailableIndicators(data);
};
```

### 2. μ»¤μ¤ν…€ μ§€ν‘ ν‘μ‹
- **"μ»¤μ¤ν…€" λ°°μ§€** ν‘μ‹
- **λ‹¤μ¤‘ μ¶λ ¥ ν‘μ‹** (2κ° μ΄μƒ μ‹)
- **μΉ΄ν…κ³ λ¦¬λ³„ μ•„μ΄μ½** μλ™ λ§¤ν•‘

### 3. λ™μ  νλΌλ―Έν„° UI
```typescript
// params_schemaλ¥Ό νμ‹±ν•μ—¬ κΈ°λ³Έκ°’ μ¶”μ¶
const parseDefaultParams = (paramsSchema?: string) => {
  try {
    return JSON.parse(paramsSchema);
  } catch {
    return {};
  }
};

// νλΌλ―Έν„° νƒ€μ…μ— λ”°λΌ μλ™ UI μƒμ„±
- number β†’ Input[type="number"]
- string (OHLC) β†’ select
- κΈ°νƒ€ β†’ text input
```

### 4. μ—λ¬ μ²λ¦¬
- **λ΅λ”© μƒνƒ** - μ¤ν”Όλ„ ν‘μ‹
- **μ—λ¬ μƒνƒ** - μ—λ¬ λ©”μ‹μ§€ + "μ¬μ‹λ„" λ²„νΌ
- **λΉ μƒνƒ** - μ•λ‚΄ λ©”μ‹μ§€

## μ‚¬μ© μμ‹

### μ‹λ‚λ¦¬μ¤: μ»¤μ¤ν…€ VWAP μ§€ν‘ μ‚¬μ©

1. **μ§€ν‘ λΌμ΄λΈλ¬λ¦¬μ—μ„ λ“±λ΅**
   - `/indicators/new`μ—μ„ VWAP μ§€ν‘ λ“±λ΅

2. **μ „λµ λΉλ”μ—μ„ μλ™ ν‘μ‹**
   - `/strategies/builder`λ΅ μ΄λ™
   - Step 1μ—μ„ "VWAP" μΉ΄λ“ ν™•μΈ (μ»¤μ¤ν…€ λ°°μ§€ ν‘μ‹)

3. **μ§€ν‘ μ¶”κ°€ λ° μ„¤μ •**
   - "+" λ²„νΌ ν΄λ¦­
   - νλΌλ―Έν„° μλ™ λ΅λ“ (params_schema κΈ°λ°)
   - κ°’ μμ • κ°€λ¥

4. **μ „λµ JSON μƒμ„±**
   ```json
   {
     "indicators": [
       {
         "id": "my_vwap",
         "type": "my_vwap",
         "params": {}
       }
     ]
   }
   ```

## ν™”λ©΄ κµ¬μ„±

### μ§€ν‘ μΉ΄νƒλ΅κ·Έ μ„Ήμ…
```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚ π”Ή EMA (μ§€μ μ΄λ™ν‰κ· )        [+]  β”‚
β”‚ μµκ·Ό κ°€κ²©μ— λ” ν° κ°€μ¤‘μΉλ¥Ό...      β”‚
β”‚ μΉ΄ν…κ³ λ¦¬: trend                     β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”

β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚ π“ My VWAP        [μ»¤μ¤ν…€]    [+]  β”‚
β”‚ Volume Weighted Average Price       β”‚
β”‚ μΉ΄ν…κ³ λ¦¬: volume | 1 μ¶λ ¥          β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

### μ¶”κ°€λ μ§€ν‘ μ„Ήμ…
```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚ [my_vwap] - My VWAP [μ»¤μ¤ν…€]   [Γ—] β”‚
β”‚                                     β”‚
β”‚ (νλΌλ―Έν„° μ—†μ)                     β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”

β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚ [ema_1] - EMA                  [Γ—]  β”‚
β”‚                                     β”‚
β”‚ Source: [close β–Ό]  Period: [20  ]  β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

## κΈ°μ  μ„Έλ¶€μ‚¬ν•­

### νμΌ μμ •
- **νμΌ**: `apps/web/app/strategies/builder/components/Step1_IndicatorSelector.tsx`
- **λ³€κ²½ λΌμΈ**: ~250μ¤„ β†’ ~280μ¤„
- **μ¶”κ°€λ import**:
  - `useEffect`, `useState` from 'react'
  - `indicatorApi` from '@/lib/api-client'
  - `Indicator` from '@/lib/types'
  - `Badge`, `Loader2`, `AlertCircle`, `Volume2` from UI

### νƒ€μ… μ•μ •μ„±
```typescript
// API μ‘λ‹µ νƒ€μ… μ‚¬μ©
const [availableIndicators, setAvailableIndicators] = useState<Indicator[]>([]);

// λ™μ  νλΌλ―Έν„° νƒ€μ… μ¶”λ΅ 
const valueType = typeof defaultValue; // 'number' | 'string' | ...
```

### μ„±λ¥ μµμ ν™”
- **μ΄κΈ° λ΅λ“ ν• λ²λ§** - useEffect μμ΅΄μ„± λ°°μ—΄ []
- **λ΅μ»¬ μƒνƒ μΊμ‹±** - availableIndicators state
- **μ΅°κ±΄λ¶€ λ λ”λ§** - λ΅λ”©/μ—λ¬/μ„±κ³µ μƒνƒ λ¶„λ¦¬

## νΈν™μ„±

### κΈ°μ΅΄ μ „λµ μ§€μ›
β… κΈ°μ΅΄μ— μ €μ¥λ μ „λµμ€ κ·Έλ€λ΅ μ‘λ™ν•©λ‹λ‹¤.
- λ‚΄μ¥ μ§€ν‘ (ema, sma, rsi, atr) μ™„μ „ νΈν™
- JSON κµ¬μ΅° λ³€κ²½ μ—†μ

### μƒλ΅μ΄ μ „λµ
β… μ»¤μ¤ν…€ μ§€ν‘λ¥Ό ν¬ν•¨ν• μ „λµλ„ λ™μΌν•κ² μ €μ¥λ©λ‹λ‹¤.
```json
{
  "indicators": [
    {
      "id": "custom_macd_1",
      "type": "custom_macd",
      "params": {
        "fast_period": 12,
        "slow_period": 26,
        "signal_period": 9
      }
    }
  ]
}
```

## λ°±ν…μ¤νΈ μ‹¤ν–‰

μ»¤μ¤ν…€ μ§€ν‘λ¥Ό ν¬ν•¨ν• μ „λµλ„ μ •μƒμ μΌλ΅ λ°±ν…μ¤νΈλ©λ‹λ‹¤:

```
1. μ „λµ μ €μ¥ β†’ strategies ν…μ΄λΈ”
2. Run μƒμ„± β†’ runs ν…μ΄λΈ”
3. StrategyParser μ΄κΈ°ν™”
   β†“
4. μ»¤μ¤ν…€ μ§€ν‘ λ™μ  λ΅λ“ (indicator_loader.py)
   β†“
5. μ§€ν‘ κ³„μ‚° (indicators.py)
   β†“
6. λ°±ν…μ¤νΈ μ‹¤ν–‰ (backtest_engine.py)
```

## νΈλ¬λΈ”μν…

### μ§€ν‘ λ©λ΅μ΄ ν‘μ‹λμ§€ μ•μ

**μ¦μƒ**: "μ§€ν‘ λ©λ΅μ„ λ¶λ¬μ¬ μ μ—†μµλ‹λ‹¤" μ—λ¬

**μ›μΈ**: Backend API μ„λ²„κ°€ μ‹¤ν–‰λμ§€ μ•μ

**ν•΄κ²°**:
```bash
cd /home/wonbbo/algoforge
python -m uvicorn apps.api.main:app --reload --port 6000
```

### μ»¤μ¤ν…€ μ§€ν‘κ°€ ν‘μ‹λμ§€ μ•μ

**μ¦μƒ**: λ‚΄μ¥ μ§€ν‘λ§ ν‘μ‹λ¨

**μ›μΈ**: μ»¤μ¤ν…€ μ§€ν‘κ°€ λ“±λ΅λμ§€ μ•μ

**ν•΄κ²°**:
1. `/indicators`λ΅ μ΄λ™
2. λ“±λ΅λ μ§€ν‘ ν™•μΈ
3. ν•„μ” μ‹ μƒλ΅ λ“±λ΅

### νλΌλ―Έν„° UIκ°€ ν‘μ‹λμ§€ μ•μ

**μ¦μƒ**: "νλΌλ―Έν„° μ—†μ" λ©”μ‹μ§€

**μ›μΈ**: `params_schema`κ°€ λΉ„μ–΄μκ±°λ‚ μλ»λ JSON

**ν•΄κ²°**:
1. μ§€ν‘ μƒμ„Έ νμ΄μ§€μ—μ„ `params_schema` ν™•μΈ
2. μ ν¨ν• JSON ν•μ‹μΌλ΅ μμ •
   ```json
   {"period": 20, "source": "close"}
   ```

## ν–¥ν›„ κ°μ„  μ‚¬ν•­

### Phase 2
- [ ] μ§€ν‘ μΉ΄ν…κ³ λ¦¬λ³„ νƒ­
- [ ] μ§€ν‘ κ²€μƒ‰ κΈ°λ¥
- [ ] μ¦κ²¨μ°ΎκΈ° μ§€ν‘

### Phase 3
- [ ] μ§€ν‘ λ―Έλ¦¬λ³΄κΈ° (μ°¨νΈ)
- [ ] μ§€ν‘ μ΅°ν•© μ¶”μ²
- [ ] νλΌλ―Έν„° μλ™ μµμ ν™”

## μ™„λ£ μ²΄ν¬λ¦¬μ¤νΈ

- β… API μ—°λ™
- β… λ™μ  λ΅λ”©
- β… μ»¤μ¤ν…€ μ§€ν‘ ν‘μ‹
- β… "μ»¤μ¤ν…€" λ°°μ§€
- β… λ‹¤μ¤‘ μ¶λ ¥ ν‘μ‹
- β… λ™μ  νλΌλ―Έν„° UI
- β… μ—λ¬ μ²λ¦¬
- β… λ΅λ”© μƒνƒ
- β… λ¦°ν„° κ²€μ¦ (0κ° μ¤λ¥)
- β… κΈ°μ΅΄ μ „λµ νΈν™μ„±

---

**κµ¬ν„ μΌμ**: 2025-12-13  
**κµ¬ν„μ**: AI Assistant  
**μƒνƒ**: μ™„λ£ β…  
**μν–¥λ°›λ” νμΌ**: 1κ°  
**λ¦°ν„° μ¤λ¥**: 0κ°

