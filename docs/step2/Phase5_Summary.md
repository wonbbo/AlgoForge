# Phase 5 ì™„ë£Œ ìš”ì•½

## ğŸ‰ Phase 5 ì™„ë£Œ!

**êµ¬í˜„ ì¼ì**: 2025ë…„ 12ì›” 13ì¼  
**ìƒíƒœ**: âœ… ì™„ë£Œ  
**ë‹¤ìŒ ë‹¨ê³„**: Phase 6 - ê³ ê¸‰ ê¸°ëŠ¥ (ì„ íƒ)

---

## ğŸ“Š í•œëˆˆì— ë³´ê¸°

| í•­ëª© | ë‚´ìš© |
|------|------|
| **ì‹ ê·œ íŒŒì¼** | 4ê°œ |
| **ìˆ˜ì • íŒŒì¼** | 2ê°œ |
| **ì´ ì½”ë“œ ë¼ì¸** | ~570ì¤„ |
| **ì¶”ê°€ëœ ê¸°ëŠ¥** | 5ê°œ |
| **ì°¨íŠ¸ ì»´í¬ë„ŒíŠ¸** | 2ê°œ |
| **ìƒˆ í˜ì´ì§€** | 1ê°œ |

---

## âœ… ì™„ë£Œëœ ì‘ì—…

### 1. TradingView Lightweight Charts í†µí•©
- âœ… ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜ ë° ì„¤ì •
- âœ… TypeScript íƒ€ì… ì •ì˜
- âœ… ë°˜ì‘í˜• ì°¨íŠ¸ êµ¬í˜„

### 2. Metrics ì°¨íŠ¸ ì»´í¬ë„ŒíŠ¸
- âœ… Equity Curve (ìì‚° ë³€í™” ì°¨íŠ¸)
  - ê±°ë˜ ì‹œê°„ì— ë”°ë¥¸ ì”ê³  ë³€í™”
  - ë…¹ìƒ‰ ë¼ì¸ ì°¨íŠ¸
  - ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸
- âœ… Drawdown Chart (ì†ì‹¤í­ ì°¨íŠ¸)
  - ìµœê³ ì  ëŒ€ë¹„ ì†ì‹¤í­
  - ë¹¨ê°„ìƒ‰ Area ì°¨íŠ¸
  - ë°±ë¶„ìœ¨ í‘œì‹œ

### 3. Trade ìƒì„¸ í˜ì´ì§€
- âœ… ì§„ì… ì •ë³´ í‘œì‹œ
- âœ… ì†ì ˆ/ìµì ˆ ì„¤ì • í‘œì‹œ
- âœ… ê±°ë˜ ê²°ê³¼ í‘œì‹œ
- âœ… Leg ìƒì„¸ í…Œì´ë¸”
- âœ… ë°©í–¥/ìŠ¹íŒ¨ ë°°ì§€
- âœ… ìƒ‰ìƒ ì½”ë”© (ìˆ˜ìµ/ì†ì‹¤)

### 4. Toast ì•Œë¦¼ ì‹œìŠ¤í…œ
- âœ… Run ìƒì„± ì•Œë¦¼
- âœ… ë°ì´í„° ë¡œë“œ ì•Œë¦¼
- âœ… ì—ëŸ¬ ì•Œë¦¼
- âœ… ìë™ ì‚¬ë¼ì§

### 5. Run ìƒì„¸ í˜ì´ì§€ ê°œì„ 
- âœ… ì°¨íŠ¸ í†µí•©
- âœ… í´ë¦­ ê°€ëŠ¥í•œ Trade í…Œì´ë¸”
- âœ… Toast ì•Œë¦¼ ì¶”ê°€
- âœ… ë°˜ì‘í˜• ë ˆì´ì•„ì›ƒ

---

## ğŸ“‚ ìƒì„±/ìˆ˜ì •ëœ íŒŒì¼

### ì‹ ê·œ íŒŒì¼ (4ê°œ)
```
apps/web/app/runs/[id]/
â”œâ”€ components/
â”‚  â”œâ”€ EquityCurveChart.tsx          âœ¨ ì‹ ê·œ (140ì¤„)
â”‚  â””â”€ DrawdownChart.tsx             âœ¨ ì‹ ê·œ (130ì¤„)
â””â”€ trades/
   â””â”€ [tradeId]/
      â””â”€ page.tsx                    âœ¨ ì‹ ê·œ (250ì¤„)
```

### ìˆ˜ì • íŒŒì¼ (2ê°œ)
```
apps/web/app/runs/
â”œâ”€ page.tsx                          ğŸ”§ ìˆ˜ì • (Toast ì¶”ê°€)
â””â”€ [id]/
   â””â”€ page.tsx                       ğŸ”§ ìˆ˜ì • (ì°¨íŠ¸ í†µí•©)
```

---

## ğŸ¯ í•µì‹¬ ì„±ê³¼

### 1. ì „ë¬¸ì ì¸ ë°ì´í„° ì‹œê°í™”
```
[Before]
- ìˆ«ìë¡œë§Œ í‘œì‹œë˜ëŠ” Metrics
- ìì‚° ë³€í™” ì¶”ì  ë¶ˆê°€
- Drawdown íŒŒì•… ì–´ë ¤ì›€

[After]
âœ… Equity Curve ì°¨íŠ¸ë¡œ ìì‚° ë³€í™” ì¶”ì 
âœ… Drawdown ì°¨íŠ¸ë¡œ ë¦¬ìŠ¤í¬ ì‹œê°í™”
âœ… ì§ê´€ì ì¸ ë°ì´í„° ì´í•´
```

### 2. ì™„ì „í•œ Trade ë¶„ì„
```
[Before]
- Trade ëª©ë¡ë§Œ í‘œì‹œ
- ìƒì„¸ ì •ë³´ í™•ì¸ ë¶ˆê°€
- Leg ë‚´ì—­ ìˆ¨ê²¨ì§

[After]
âœ… Trade ìƒì„¸ í˜ì´ì§€ ì¶”ê°€
âœ… ì§„ì…/ì²­ì‚° ì •ë³´ ìƒì„¸ í‘œì‹œ
âœ… Leg ë‹¨ìœ„ ì²­ì‚° ë‚´ì—­ í™•ì¸
```

### 3. í–¥ìƒëœ ì‚¬ìš©ì ê²½í—˜
```
[Before]
- ì‘ì—… ê²°ê³¼ í™•ì¸ ì–´ë ¤ì›€
- ì—ëŸ¬ ë©”ì‹œì§€ ë¶ˆëª…í™•
- í˜ì´ì§€ ì´ë™ ë¶ˆí¸

[After]
âœ… Toast ì•Œë¦¼ìœ¼ë¡œ ì¦‰ê° í”¼ë“œë°±
âœ… ëª…í™•í•œ ì—ëŸ¬ ë©”ì‹œì§€
âœ… í´ë¦­ ê°€ëŠ¥í•œ í…Œì´ë¸”
```

---

## ğŸš€ ì‹¤í–‰ ë°©ë²•

### 1. ë°±ì—”ë“œ ì„œë²„ ì‹¤í–‰
```bash
cd C:\Users\wonbbo\Workspace\Cursor\AlgoForge
python -m uvicorn apps.api.main:app --host 0.0.0.0 --port 6000 --reload
```

### 2. í”„ë¡ íŠ¸ì—”ë“œ ì„œë²„ ì‹¤í–‰
```bash
cd apps/web
pnpm dev
```

### 3. ë¸Œë¼ìš°ì € ì ‘ì†
- Run ëª©ë¡: http://localhost:5001/runs
- Run ìƒì„¸: http://localhost:5001/runs/[id]
- Trade ìƒì„¸: http://localhost:5001/runs/[id]/trades/[tradeId]

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### ì‹œë‚˜ë¦¬ì˜¤ 1: Equity Curve ì°¨íŠ¸ í™•ì¸ âœ…
1. ì™„ë£Œëœ Run ìƒì„¸ í˜ì´ì§€ ì ‘ì†
2. "ìì‚° ë³€í™” (Equity Curve)" ì„¹ì…˜ í™•ì¸
3. ë…¹ìƒ‰ ë¼ì¸ ì°¨íŠ¸ í™•ì¸
4. ë§ˆìš°ìŠ¤ ì˜¤ë²„í•˜ì—¬ ê°’ í™•ì¸
5. ë¸Œë¼ìš°ì € ì°½ í¬ê¸° ì¡°ì ˆí•˜ì—¬ ë°˜ì‘í˜• í™•ì¸

**ê²°ê³¼**: 
- âœ… ì°¨íŠ¸ ì •ìƒ ë Œë”ë§
- âœ… ìì‚° ë³€í™” ì¶”ì  ê°€ëŠ¥
- âœ… ë°˜ì‘í˜• ì‘ë™

### ì‹œë‚˜ë¦¬ì˜¤ 2: Drawdown ì°¨íŠ¸ í™•ì¸ âœ…
1. Run ìƒì„¸ í˜ì´ì§€ì—ì„œ "ì†ì‹¤í­ (Drawdown)" ì„¹ì…˜ í™•ì¸
2. ë¹¨ê°„ìƒ‰ Area ì°¨íŠ¸ í™•ì¸
3. Drawdown êµ¬ê°„ í™•ì¸
4. ìµœëŒ€ Drawdown ì§€ì  í™•ì¸

**ê²°ê³¼**:
- âœ… ì°¨íŠ¸ ì •ìƒ ë Œë”ë§
- âœ… Drawdown ì‹œê°í™”
- âœ… ë¦¬ìŠ¤í¬ íŒŒì•… ê°€ëŠ¥

### ì‹œë‚˜ë¦¬ì˜¤ 3: Trade ìƒì„¸ í˜ì´ì§€ í™•ì¸ âœ…
1. Run ìƒì„¸ í˜ì´ì§€ì˜ ê±°ë˜ ë‚´ì—­ í…Œì´ë¸”ì—ì„œ Trade í´ë¦­
2. Trade ìƒì„¸ í˜ì´ì§€ë¡œ ì´ë™
3. ì§„ì… ì •ë³´, ì†ì ˆ/ìµì ˆ ì„¤ì •, ê±°ë˜ ê²°ê³¼ í™•ì¸
4. Leg í…Œì´ë¸” í™•ì¸
5. ë’¤ë¡œ ê°€ê¸° ë²„íŠ¼ìœ¼ë¡œ ëŒì•„ê°€ê¸°

**ê²°ê³¼**:
- âœ… ìƒì„¸ ì •ë³´ ì •í™•íˆ í‘œì‹œ
- âœ… Leg ë‚´ì—­ í™•ì¸ ê°€ëŠ¥
- âœ… ë„¤ë¹„ê²Œì´ì…˜ ì •ìƒ ì‘ë™

### ì‹œë‚˜ë¦¬ì˜¤ 4: Toast ì•Œë¦¼ í™•ì¸ âœ…
1. Run ìƒì„± ì‹œ Toast ì•Œë¦¼ í™•ì¸
2. Run ë°ì´í„° ë¡œë“œ ì‹œ Toast ì•Œë¦¼ í™•ì¸
3. ì—ëŸ¬ ë°œìƒ ì‹œ Toast ì•Œë¦¼ í™•ì¸

**ê²°ê³¼**:
- âœ… ì„±ê³µ ì•Œë¦¼ í‘œì‹œ
- âœ… ì—ëŸ¬ ì•Œë¦¼ í‘œì‹œ
- âœ… ìë™ ì‚¬ë¼ì§

---

## ğŸ’¡ ì£¼ìš” íŠ¹ì§•

### 1. Equity Curve Chart
```typescript
// ìì‚° ë³€í™” ì¶”ì 
let currentBalance = initialBalance

for (const trade of trades) {
  currentBalance += trade.total_pnl
  data.push({
    time: lastLeg.exit_timestamp,
    value: currentBalance,
  })
}
```

**íŠ¹ì§•**:
- ì´ˆê¸° ì”ê³ ë¶€í„° ì‹œì‘
- ê° ê±°ë˜ ì¢…ë£Œ ì‹œì ì˜ ì”ê³  í‘œì‹œ
- ë…¹ìƒ‰ ë¼ì¸ (#10b981)
- ê°€ê²© í¬ë§·: $1,234.56

### 2. Drawdown Chart
```typescript
// Drawdown ê³„ì‚°
let peak = initialBalance

for (const trade of trades) {
  currentBalance += trade.total_pnl
  
  if (currentBalance > peak) {
    peak = currentBalance
  }
  
  const drawdown = ((peak - currentBalance) / peak) * 100
  data.push({
    time: lastLeg.exit_timestamp,
    value: -drawdown,
  })
}
```

**íŠ¹ì§•**:
- ìµœê³ ì  ì¶”ì 
- Drawdown ë°±ë¶„ìœ¨ ê³„ì‚°
- ë¹¨ê°„ìƒ‰ Area ì°¨íŠ¸
- í¬ë§·: -12.34%

### 3. Trade ìƒì„¸ í˜ì´ì§€
```typescript
// Trade ì •ë³´ í‘œì‹œ
<Card>
  <CardHeader>
    <CardTitle>ì§„ì… ì •ë³´</CardTitle>
  </CardHeader>
  <CardContent>
    <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
      <div>
        <p className="text-sm text-muted-foreground">ì§„ì… ì‹œê°</p>
        <p className="font-medium">{formatTimestamp(trade.entry_timestamp)}</p>
      </div>
      {/* ... */}
    </div>
  </CardContent>
</Card>
```

**íŠ¹ì§•**:
- ì§„ì…/ì²­ì‚° ì •ë³´ ìƒì„¸ í‘œì‹œ
- Leg í…Œì´ë¸”
- ë°©í–¥/ìŠ¹íŒ¨ ë°°ì§€
- ìƒ‰ìƒ ì½”ë”©

---

## ğŸ“ˆ ì§„í–‰ ìƒí™©

### ì™„ë£Œëœ Phase
- âœ… **Phase 1**: í”„ë¡œì íŠ¸ ì„¤ì • ë° ê¸°ë³¸ êµ¬ì¡°
- âœ… **Phase 2**: UI ì»´í¬ë„ŒíŠ¸ êµ¬í˜„
- âœ… **Phase 3**: í…ŒìŠ¤íŠ¸ ë° ë””ë²„ê¹…
- âœ… **Phase 4**: í”„ë¡ íŠ¸ì—”ë“œ-ë°±ì—”ë“œ í†µí•©
- âœ… **Phase 5**: Run ì‹¤í–‰ ë° ê²°ê³¼ ì‹œê°í™” â­

### ë‹¤ìŒ Phase (ì„ íƒ)
- â³ **Phase 6**: ê³ ê¸‰ ê¸°ëŠ¥
  - ì‹¤ì‹œê°„ Run ìƒíƒœ ì—…ë°ì´íŠ¸
  - Trade í•„í„°ë§ ë° ì •ë ¬
  - Metrics ë¹„êµ
  - ë°ì´í„° ë‚´ë³´ë‚´ê¸°
  - ì¶”ê°€ ì°¨íŠ¸

---

## ğŸ“ í•™ìŠµ í¬ì¸íŠ¸

### 1. TradingView Lightweight Charts
- ì°¨íŠ¸ ìƒì„± ë° ì„¤ì •
- ë°ì´í„° ë³€í™˜ ë° í‘œì‹œ
- ë°˜ì‘í˜• ì°¨íŠ¸ êµ¬í˜„
- ë©”ëª¨ë¦¬ ê´€ë¦¬

### 2. ë°ì´í„° ì‹œê°í™”
- Equity Curve ê³„ì‚°
- Drawdown ê³„ì‚°
- ì‹œê³„ì—´ ë°ì´í„° ì²˜ë¦¬

### 3. React Hooks
- `useRef`ë¡œ ì°¨íŠ¸ ì¸ìŠ¤í„´ìŠ¤ ê´€ë¦¬
- `useEffect`ë¡œ ì°¨íŠ¸ ìƒì„± ë° ì •ë¦¬
- ì˜ì¡´ì„± ë°°ì—´ ê´€ë¦¬

### 4. TypeScript
- ì°¨íŠ¸ API íƒ€ì… ì •ì˜
- Generic íƒ€ì… ì‚¬ìš©
- Type Guard

---

## ğŸ”§ ê¸°ìˆ  ìŠ¤íƒ

### ì°¨íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬
- **TradingView Lightweight Charts** v4.x
  - ê²½ëŸ‰ ì°¨íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬
  - ê¸ˆìœµ ë°ì´í„° ì‹œê°í™” ìµœì í™”
  - TypeScript ì§€ì›
  - ë°˜ì‘í˜• ë””ìì¸

### ì„¤ì¹˜
```bash
pnpm add lightweight-charts
```

### ì‚¬ìš© ì˜ˆì‹œ
```typescript
import { createChart, ColorType } from 'lightweight-charts'

const chart = createChart(container, {
  layout: {
    background: { type: ColorType.Solid, color: 'transparent' },
  },
  width: 800,
  height: 300,
})

const lineSeries = chart.addLineSeries({
  color: '#10b981',
  lineWidth: 2,
})

lineSeries.setData([
  { time: 1609459200, value: 10000 },
  { time: 1609545600, value: 10500 },
])
```

---

## âš ï¸ ì£¼ì˜ ì‚¬í•­

### ì ˆëŒ€ ê¸ˆì§€ (MUST NOT)
1. âŒ ì°¨íŠ¸ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì •ë¦¬í•˜ì§€ ì•Šê³  ì»´í¬ë„ŒíŠ¸ ì–¸ë§ˆìš´íŠ¸
2. âŒ ëŒ€ëŸ‰ ë°ì´í„°ë¥¼ ìƒ˜í”Œë§ ì—†ì´ ì°¨íŠ¸ì— í‘œì‹œ
3. âŒ ì°¨íŠ¸ í¬ê¸°ë¥¼ ê³ ì •ê°’ìœ¼ë¡œ ì„¤ì •

### í•„ìˆ˜ ì¤€ìˆ˜ (MUST)
1. âœ… `useEffect` cleanupì—ì„œ ì°¨íŠ¸ ì œê±°
2. âœ… ìœˆë„ìš° ë¦¬ì‚¬ì´ì¦ˆ ì´ë²¤íŠ¸ ì²˜ë¦¬
3. âœ… ë°ì´í„° ë³€í™˜ ì‹œ ì—ëŸ¬ ì²˜ë¦¬
4. âœ… TypeScript íƒ€ì… ì •ì˜

---

## ğŸ“– ë¬¸ì„œ ê°€ì´ë“œ

### ìƒì„¸ êµ¬í˜„ ë‚´ìš©
ğŸ‘‰ `Phase5_Implementation_Report.md`

### ì´ì „ Phase
ğŸ‘‰ `Phase1_Implementation_Report.md`  
ğŸ‘‰ `Phase2_Implementation_Report.md`  
ğŸ‘‰ `Phase3_Implementation_Report.md`  
ğŸ‘‰ `Phase4_Implementation_Report.md`

### ì „ì²´ ê°€ì´ë“œ
ğŸ‘‰ `../AlgoForge_Strategy_Builder_Implementation_Guide_v1.0.md`

---

## ğŸ”„ ë‹¤ìŒ ë‹¨ê³„: Phase 6 (ì„ íƒ)

### Phase 6 ëª©í‘œ
1. **ì‹¤ì‹œê°„ Run ìƒíƒœ ì—…ë°ì´íŠ¸**
   - í´ë§ ë˜ëŠ” WebSocket
   - ì§„í–‰ë¥  í‘œì‹œ
   - ìë™ ê°±ì‹ 

2. **Trade í•„í„°ë§ ë° ì •ë ¬**
   - ë°©í–¥ í•„í„° (LONG/SHORT)
   - ìŠ¹íŒ¨ í•„í„°
   - ë‚ ì§œ ë²”ìœ„ í•„í„°
   - ì†ìµ ì •ë ¬

3. **Metrics ë¹„êµ**
   - ì—¬ëŸ¬ Run ë¹„êµ
   - ì°¨íŠ¸ ì˜¤ë²„ë ˆì´
   - ì„±ëŠ¥ ë¹„êµ í…Œì´ë¸”

4. **ë°ì´í„° ë‚´ë³´ë‚´ê¸°**
   - CSV ë‚´ë³´ë‚´ê¸°
   - JSON ë‚´ë³´ë‚´ê¸°
   - PDF ë¦¬í¬íŠ¸

5. **ì¶”ê°€ ì°¨íŠ¸**
   - PnL Distribution
   - Win/Loss Streak
   - Trade Duration
   - Monthly Returns

---

## ğŸ† ê²°ë¡ 

Phase 5ëŠ” **Run ì‹¤í–‰ ë° ê²°ê³¼ ì‹œê°í™”**ë¥¼ ì„±ê³µì ìœ¼ë¡œ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.

### ë‹¬ì„±í•œ ê²ƒ
- âœ… ì „ë¬¸ì ì¸ ì°¨íŠ¸ ì‹œê°í™”
- âœ… ì™„ì „í•œ Trade ë¶„ì„ ê¸°ëŠ¥
- âœ… í–¥ìƒëœ ì‚¬ìš©ì ê²½í—˜
- âœ… Toast ì•Œë¦¼ ì‹œìŠ¤í…œ

### ì¤€ë¹„ëœ ê²ƒ
- âœ… ë°±í…ŒìŠ¤íŠ¸ ê²°ê³¼ ì‹œê°í™” ì™„ë£Œ
- âœ… Trade ìƒì„¸ ë¶„ì„ ê°€ëŠ¥
- âœ… ì‚¬ìš©ì ì¹œí™”ì  UI/UX
- âœ… ê³ ê¸‰ ê¸°ëŠ¥ í™•ì¥ ì¤€ë¹„

### ì‚¬ìš©ì ê°€ì¹˜
- âœ… ì°¨íŠ¸ë¡œ ìì‚° ë³€í™” í•œëˆˆì— íŒŒì•…
- âœ… Drawdownìœ¼ë¡œ ë¦¬ìŠ¤í¬ ì‹œê°í™”
- âœ… Trade ìƒì„¸ ë‚´ì—­ í™•ì¸ ê°€ëŠ¥
- âœ… ì¦‰ê°ì ì¸ í”¼ë“œë°±

---

**Phase 1 ì™„ë£Œ** âœ…  
**Phase 2 ì™„ë£Œ** âœ…  
**Phase 3 ì™„ë£Œ** âœ…  
**Phase 4 ì™„ë£Œ** âœ…  
**Phase 5 ì™„ë£Œ** âœ… â­  
**Phase 6 ì¤€ë¹„ ì™„ë£Œ** âœ…

---

**ì‘ì„±ì¼**: 2025-12-13  
**ì‘ì„±ì**: Cursor AI  
**ë²„ì „**: 1.0

